%dw 2.0
output application/java 
import * from dw::core::Strings
var stateCodeMap = {
      "Alabama" : "AL",
      "Arizona" : "AZ",
      "Arkansas" : "AR",
      "California" : "CA",
      "Colorado" : "CO",
      "Connecticut" : "CT",
      "Delaware" : "DE",
      "Florida" : "FL",
      "Georgia" : "GA",
      "Idaho" : "ID",
      "Illinois" : "IL",
      "Indiana" : "IN",
      "Iowa" : "IA",
      "Kansas" : "KS",
      "Kentucky" : "KY",
      "Louisiana" : "LA",
      "Maine" : "ME",
      "Maryland" : "MD",
      "Massachusetts" : "MA",
      "Michigan" : "MI",
      "Minnesota" : "MN",
      "Mississippi" : "MS",
      "Missouri" : "MO",
      "Montana" : "MT",
      "Nebraska" : "NE",
      "Nevada" : "NV",
      "New Hampshire" : "NH",
      "New Jersey" : "NJ",
      "New Mexico"  : "NM",
      "New York" : "NY",
      "North Carolina" : "NC",
      "North Dakota" : "ND",
      "Ohio" : "OH",
      "Oklahoma" : "OK",
      "Oregon" : "OR",
      "Pennsylvania" : "PA",
      "Rhode Island" : "RI",
      "South Carolina" : "SC",
      "South Dakota" : "SD",
      "Tennessee" : "TN",
      "Texas" : "TX",
      "Utah"  : "UT",
      "Vermont" : "VT",
      "Virginia" : "VA",
      "Washington" : "WA",
      "West Virginia" : "WV",
      "Wisconsin" : "WI",
      "Wyoming" : "WY"
      }
---
vars.clientDetails filter (vars.addressDetailsMissing[$$].person != $.Id) map ( {
	//MCI : pad(0,10 - (sizeOf ($.DEL_MCI__c )) ++ $.DEL_MCI__c) default "",
	MCI : leftPad($.DEL_MCI__c,10,"0") default "",
	SSN : "000000000",
	"FST-NAM" : upper ($.FirstName),
	"LST-NAM" : upper ($.LastName),
	MI : " ",
	SUFFIX : $.DEL_Suffix__c,
	DOB : $.Birthdate,
	DOD : $.DEL_Date_of_Death__c default "0000-00-00",
	"RCE-CDE" : $.DEL_Race_Primary__c,
	SEX : $.DEL_Gender__c,
	"LANGUAGE-INDICATOR" : $.DEL_Language__c,
	"MOTHERS-MCI" : "0000000000",
	"LIVING-ARRANGEMENT" : "01",
	"MEDICARE-NUMBER" : "",
	"BUY-IN-EFFECTIVE-DATE" : "",
	"AID-CAT1" : "DC" ,
	"ELIG-BEGIN1" : payload[$.Id].Eligibility_start_date__c[0] ,
	"ELIG-END1" : payload[$.Id].Eligibility_end_date__c[0] ,
	"ELIG-FLG1" : "N",
	"AID-CAT2" : "  ",
	"ELIG-BEGIN2" : "0000-00-00",
	"ELIG-END2" : "0000-00-00",
	"ELIG-FLG2" : " ",
	"CASE-NUM" :leftPad("",10,0),
	"WRKER-ID" :"DSCYFWRKR",
	POOL : "9996",
	"COUNTY-CODE" : if (vars.personAddressDetails[$.Id][0] != null) (vars.personAddressDetails[$.Id][0].County) else "NEW CASTLE",
	PHONE : "0000000000",
	"MAILING-ADDR-1" : "",
	"MAILING-ADDR-2" : "",
	"MAILING-APT-NUM" : "",
	"MAILING-CITY" : "",
	"MAILING-STATE" : "",
	"MAILING-ZIP" : "",
	"MAILING-FNAM" : "",
	"MAILING-LNAM" : "",
	"MAILING-MI" : "",
	"MAILING-SUFFIX" : "",
	"LTC-ELIG-BGN-DTE" : "0000-00-00" ,
	"LTC-ELIG-END-DTE" : "0000-00-00" ,
	"LTC-PAY-BGN-DTE" : "0000-00-00",
	"LTC-PAY-AMT" : "00000000000" ,
	"LTC-STRT-DTE" : "0000-00-00",
	"LTC-STOP-DTE" : "0000-00-00",
	"LTC-REIMB-LVL" : "",
	"HOH-MID" : leftPad($.DEL_MCI__c default "",10,"0"),
	"HOH-FNAM" : "",
	"HOH-LNAM" : "",
	"HOH-MI" : "",
	"HOH-SUFFIX" : "",
	"RESIDENCE-ADDR-1" : if ((vars.personAddressDetails[$.Id][0] != null)) (vars.personAddressDetails[$.Id][0].Street1) else "1825 Faukland Road",
	"RESIDENCE-ADDR-2" : if ((vars.personAddressDetails[$.Id][0] != null)) (vars.personAddressDetails[$.Id][0].Street2) else "DMES Related",
	"RESIDENCE-APT-NUM" : "",
	"RESIDENCE-CITY" : if (vars.personAddressDetails[$.Id][0] != null ) (vars.personAddressDetails[$.Id][0].City) else "Wilmington",
	"RESIDENCE-STATE" : "DE",//vars.personAddressDetails[$.Id][0].State
	"RESIDENCE-ZIP" : if (vars.personAddressDetails[$.Id][0] != null) (vars.personAddressDetails[$.Id][0].ZIP) else "198051195",
	"LTC-VENDOR-ID" : leftPad("",10,0),
	"LTC-FACILITY-BEGIN-DATE" : "0000-00-00",
	"LTC-FACILITY-END-DATE" : "0000-00-00",
	"RECIPIENT-PLACEMENT-LEVEL" : leftPad("",4,0),
	"PASARR-FLAG" : "",
	"DSCYF-FLAG" : "Y",
	"ETHNICITY" : $.DEL_Ethnicity__c,
	"PACE-BEGIN-DATE" : "0000-00-00",
	"PACE-END-DATE" : "0000-00-00",
	"Filler" : $.Filler
})
