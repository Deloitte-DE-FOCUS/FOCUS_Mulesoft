%dw 2.0
import * from dw::core::Strings
output application/flatfile schemaPath="DMESMember.ffd"
---
payload map {
	MCI : $.MCI,
	SSN : $.SSN,
	"FST-NAM" : if (($."FST-NAM" != null) and (sizeOf ($."FST-NAM") <= 19)) (upper ($."FST-NAM"[0 to -1] default "")) else (upper ($."FST-NAM"[0 to 19] default "")),
	"LST-NAM" : if (($."LST-NAM" != null) and (sizeOf ($."LST-NAM") <= 29)) (upper ($."LST-NAM"[0 to -1] default "")) else (upper ($."LST-NAM"[0 to 29] default "")),
	MI : $.MI,
	SUFFIX : (vars.LOVMapping[("DMES_SUFFIX-" ++ $.SUFFIX)][0] default ""),
	DOB : $.DOB,
	DOD : $.DOD,
	"RCE-CDE" : vars.LOVMapping[("DMES_RACE-" ++ $."RCE-CDE")][0] default "W",
	SEX : capitalize($.SEX[0]),
	"LANGUAGE-INDICATOR" : vars.LOVMapping[("DMES_LANGUAGE-" ++ $."LANGUAGE-INDICATOR")][0] default "E",
	"MOTHERS-MCI" : $."MOTHERS-MCI",
	"LIVING-ARRANGEMENT" : $."LIVING-ARRANGEMENT",
	"MEDICARE-NUMBER" : $."MEDICARE-NUMBER",
	"BUY-IN-EFFECTIVE-DATE" : $."BUY-IN-EFFECTIVE-DATE",
	"AID-CAT1" : $."AID-CAT1",
	"ELIG-BEGIN1" : $."ELIG-BEGIN1",
	"ELIG-END1" : $."ELIG-END1",
	"ELIG-FPL1" : $."ELIG-FPL1" ,
	"ELIG-FLG1" : $."ELIG-FLG1",
	"AID-CAT2" : $."AID-CAT2",
	"ELIG-BEGIN2" : $."ELIG-BEGIN2",
	"ELIG-END2" : $."ELIG-END2",
	"ELIG-FPL2" : $."ELIG-FPL1",
	"ELIG-FLG2" : $."ELIG-FLG2",
	"AID-CAT3" : $."AID-CAT2",
	"ELIG-BEGIN3" : $."ELIG-BEGIN2",
	"ELIG-END3" : $."ELIG-END2",
	"ELIG-FPL3"  : $."ELIG-FPL1",
	"ELIG-FLG3" : $."ELIG-FLG2",
	"AID-CAT4" : $."AID-CAT2",
	"ELIG-BEGIN4" : $."ELIG-BEGIN2",
	"ELIG-END4" : $."ELIG-END2",
	"ELIG-FPL4"  : $."ELIG-FPL1",
	"ELIG-FLG4" : $."ELIG-FLG2",
	"AID-CAT5" : $."AID-CAT2",
	"ELIG-BEGIN5" : $."ELIG-BEGIN2",
	"ELIG-END5" : $."ELIG-END2",
	"ELIG-FPL5" : $."ELIG-FPL1",
	"ELIG-FLG5" : $."ELIG-FLG2",
	"AID-CAT6" : $."AID-CAT2",
	"ELIG-BEGIN6" : $."ELIG-BEGIN2",
	"ELIG-END6" : $."ELIG-END2",
	"ELIG-FPL6"  : $."ELIG-FPL1",
	"ELIG-FLG6" : $."ELIG-FLG2",
	"AID-CAT7" : $."AID-CAT2",
	"ELIG-BEGIN7" : $."ELIG-BEGIN2",
	"ELIG-END7" : $."ELIG-END2",
	"ELIG-FPL7"  : $."ELIG-FPL1",
	"ELIG-FLG7" : $."ELIG-FLG2",
	"AID-CAT8" : $."AID-CAT2",
	"ELIG-BEGIN8" : $."ELIG-BEGIN2",
	"ELIG-END8" : $."ELIG-END2",
	"ELIG-FPL8"  : $."ELIG-FPL1",
	"ELIG-FLG8" : $."ELIG-FLG2",
	"AID-CAT9" : $."AID-CAT2",
	"ELIG-BEGIN9" : $."ELIG-BEGIN2",
	"ELIG-END9" : $."ELIG-END2",
	"ELIG-FPL9"  : $."ELIG-FPL1",
	"ELIG-FLG9" : $."ELIG-FLG2",
	"CASE-NUM" : $."CASE-NUM",
	"WRKER-ID" : $."WRKER-ID",
	POOL : $.POOL,
	"COUNTY-CODE" : ( vars.LOVMapping[("DMES_COUNTY-" ++ $."COUNTY-CODE")][0] default ""),
	PHONE : $.PHONE,
	"MAILING-ADDR-1" : upper ($."MAILING-ADDR-1"),
	"MAILING-ADDR-2" : upper ($."MAILING-ADDR-2"),
	"MAILING-APT-NUM" : upper ($."MAILING-APT-NUM"),
	"MAILING-CITY" : upper ($."MAILING-CITY"),
	"MAILING-STATE" : upper ($."MAILING-STATE"),
	"MAILING-ZIP" : upper ($."MAILING-ZIP"),
	"MAILING-FNAM" : upper ($."MAILING-FNAM"),
	"MAILING-LNAM" : upper ($."MAILING-LNAM" ),
	"MAILING-MI" : upper ($."MAILING-MI"),
	"MAILING-SUFFIX" : $."MAILING-SUFFIX",
	"LTC-ELIG-BGN-DTE1" : $."LTC-ELIG-BGN-DTE",
	"LTC-ELIG-END-DTE1" : $."LTC-ELIG-END-DTE",
	"LTC-ELIG-BGN-DTE2" : $."LTC-ELIG-BGN-DTE",
	"LTC-ELIG-END-DTE2" : $."LTC-ELIG-END-DTE",
	"LTC-ELIG-BGN-DTE3" : $."LTC-ELIG-BGN-DTE",
	"LTC-ELIG-END-DTE3" : $."LTC-ELIG-END-DTE",
	"LTC-ELIG-BGN-DTE4" : $."LTC-ELIG-BGN-DTE",
	"LTC-ELIG-END-DTE4" : $."LTC-ELIG-END-DTE",
	"LTC-ELIG-BGN-DTE5" : $."LTC-ELIG-BGN-DTE",
	"LTC-ELIG-END-DTE5" : $."LTC-ELIG-END-DTE",			
	"LTC-PAY-BGN-DTE1" : $."LTC-PAY-BGN-DTE",
	"LTC-PAY-AMT1" : $."LTC-PAY-AMT" ,
	"LTC-PAY-BGN-DTE2" : $."LTC-PAY-BGN-DTE",
	"LTC-PAY-AMT2" : $."LTC-PAY-AMT" ,	
	"LTC-PAY-BGN-DTE3" : $."LTC-PAY-BGN-DTE",
	"LTC-PAY-AMT3" : $."LTC-PAY-AMT" ,	
	"LTC-PAY-BGN-DTE4" : $."LTC-PAY-BGN-DTE",
	"LTC-PAY-AMT4" : $."LTC-PAY-AMT" ,	
	"LTC-PAY-BGN-DTE5" : $."LTC-PAY-BGN-DTE",
	"LTC-PAY-AMT5" : $."LTC-PAY-AMT" ,	
	"LTC-STRT-DTE1" : $."LTC-STRT-DTE",
	"LTC-STOP-DTE1" : $."LTC-STOP-DTE",
	"LTC-REIMB-LVL1" : "",
	"LTC-STRT-DTE2" : $."LTC-STRT-DTE",
	"LTC-STOP-DTE2" : $."LTC-STOP-DTE",	
	"LTC-REIMB-LVL2" : $."LTC-REIMB-LVL",
	"LTC-STRT-DTE3" : $."LTC-STRT-DTE",
	"LTC-STOP-DTE3" : $."LTC-STOP-DTE",
	"LTC-REIMB-LVL3" : $."LTC-REIMB-LVL",	
	"LTC-STRT-DTE4" : $."LTC-STRT-DTE",
	"LTC-STOP-DTE4" : $."LTC-STOP-DTE",
	"LTC-REIMB-LVL4" : $."LTC-REIMB-LVL",	
	"LTC-STRT-DTE5" : $."LTC-STRT-DTE",
	"LTC-STOP-DTE5" : $."LTC-STOP-DTE",
	"LTC-REIMB-LVL5" : $."LTC-REIMB-LVL",		
	"HOH-MID" : $."HOH-MID",
	"HOH-FNAM" :$."HOH-FNAM",
	"HOH-LNAM" : $."HOH-LNAM",
	"HOH-MI" : $."HOH-MI",
	"HOH-SUFFIX" : $."HOH-SUFFIX",
	"RESIDENCE-ADDR-1" : if (($."RESIDENCE-ADDR-1" != null) and (sizeOf ($."RESIDENCE-ADDR-1") <= 30)) (upper ($."RESIDENCE-ADDR-1"[0 to -1] default "")) else (upper ($."RESIDENCE-ADDR-1"[0 to 30] default "")),
	"RESIDENCE-ADDR-2" : if (($."RESIDENCE-ADDR-2" != null) and (sizeOf ($."RESIDENCE-ADDR-2") <= 29)) (upper ($."RESIDENCE-ADDR-2"[0 to -1] default "")) else (upper ($."RESIDENCE-ADDR-2"[0 to 29] default "")),
	"RESIDENCE-APT-NUM" : "",//if (($."RESIDENCE-APT-NUM" != null) and (sizeOf ($."RESIDENCE-APT-NUM")) <= 4) (upper ($."RESIDENCE-APT-NUM"[0 to -1] default "")) else (upper ($."RESIDENCE-APT-NUM"[0 to 4] default ""))
	"RESIDENCE-CITY" : if (($."RESIDENCE-CITY" != null) and (sizeOf ($."RESIDENCE-CITY") <= 14)) (upper ($."RESIDENCE-CITY"[0 to -1] default "")) else (upper ($."RESIDENCE-CITY"[0 to 14] default "")),
	"RESIDENCE-STATE" : upper ($."RESIDENCE-STATE"[0 to -1]),
	"RESIDENCE-ZIP" : if ($."RESIDENCE-ZIP" != null and $."RESIDENCE-ZIP" != "")(($."RESIDENCE-ZIP" replace /-/ with(""))[0 to -1]) else " ",
	"LTC-VENDOR-ID" : $."LTC-VENDOR-ID",
	"LTC-FACILITY-BEGIN-DATE" : $."LTC-FACILITY-BEGIN-DATE",
	"LTC-FACILITY-END-DATE" : $."LTC-FACILITY-END-DATE",
	"RECIPIENT-PLACEMENT-LEVEL" : $."RECIPIENT-PLACEMENT-LEVEL",
	"PASARR-FLAG" : $."PASARR-FLAG",
	"DSCYF-FLAG" : $."DSCYF-FLAG",
	"ETHNICITY" : vars.LOVMapping[("DMES_ETHNICITY-" ++  $."ETHNICITY")][0] default "",
	"PACE-BEGIN-DATE" : $."PACE-BEGIN-DATE",
	"PACE-END-DATE" : $."PACE-END-DATE",
	"Filler" : ""
	
}
